#!/usr/bin/env bash
set -eux

### --start_docs

## Set up the non-root user for installation and deployment tasks
## ==============================================================


## * Create non-root user on undercloud
## ::

id -u "{{ non_root_user }}" || \
sudo useradd -s /bin/bash -d /home/"{{ non_root_user }}" "{{ non_root_user }}"

## * Grant sudo privileges to non-root user on undercloud
## ::

echo "{{ non_root_user }} ALL=(ALL) NOPASSWD:ALL" | sudo tee /etc/sudoers.d/{{ non_root_user }}
sudo chown root:root  /etc/sudoers.d/{{ non_root_user }}
sudo chmod 440 /etc/sudoers.d/{{ non_root_user }}

### --stop_docs
